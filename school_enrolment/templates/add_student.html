<!doctype html>
<html lang="en">
<head>
    <!-- Required meta tags -->
    <script
            src="https://code.jquery.com/jquery-3.6.0.js"
            integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk="
            crossorigin="anonymous"></script>
    <script
            src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"
            integrity="sha256-T0Vest3yCU7pafRw9r+settMBX6JkKN06dqBnpQ8d30="
            crossorigin="anonymous"></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link crossorigin="anonymous" href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/css/select2.min.css"
          integrity="sha512-nMNlpuaDPrqlEls3IX/Q56H36qvBASwb3ipuo3MxeWbsQB1881ox0cRv7UPTgBlriqoynt35KjEwgGUeUXIPnw=="
          rel="stylesheet"/>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    <title>Home</title>
</head>
<body>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-gtEjrD/SeCtmISkJkNUaaKMoLD0//ElJ19smozuHV6z3Iehds+3Ulb9Bn9Plx0x4" crossorigin="anonymous"></script>




<section class="content container-fluid align-middle w-75 p-3 "  >
    <br>
    <div class="container-fluid">
        <div class="row">
            <div class="col-4">
                <a class="btn btn-primary" href="{% url 'home'  %}"> << Back to Home</a> <br><br>
            </div>
        </div>
    </div>


    {% if messages %}
    <div class="form-group">
        <div class="col-12">
            {% for message in messages %}
            {% if message.tags == "error" %}
            <div class="alert alert-danger alert-dismissible fade show" role="alert" style="margin-top: 10px;">
                {{ message }}
                <button aria-label="Close" class="close" data-dismiss="alert" type="button">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            {% elif message.tags == "success" %}
            <div class="alert alert-success alert-dismissible fade show" role="alert" style="margin-top: 10px;">
                {{ message }}
                <button aria-label="Close" class="close" data-dismiss="alert" type="button">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            {% endif %}
            {% endfor %}
        </div>
    </div>
    {% endif %}

    <div class="row">

        <div class="col-md-12" style="width: 80%">
            <!-- general form elements -->
            <div class="card card-primary">
                <div class="card-header">
                    <h3 class="card-title">Add Student </h3>
                </div>
                <!-- /.card-header -->
                <!-- form start -->
                <form action="{% url 'add_student' %}" method="POST" role="form">
                    {% csrf_token %}
                    <div class="card-body">

                        <div class="form-row">
                            <div class="form-group col-md-4">
                                <label for="inputName">Student Name</label>
                                <input class="form-control" id="inputName" name="inputName"
                                       placeholder="Student Name" required type="text">
                            </div>
                            <div class="form-group col-md-4">
                                <label for="inputFatherName">Father Name</label>
                                <input class="form-control" id="inputFatherName" name="inputFatherName"
                                       placeholder="Father Name" required type="text">
                            </div>
                            <div class="form-group col-md-4">
                                <label for="dob">D.O.B</label>
                                <input class="form-control" id="dob" name="dob" required
                                       placeholder="D.O.B" required type="date"  max="2011-06-01" >
                            </div>
                            <div class="form-group col-md-4">
                                <label for="inputAddress">Address</label>
                                <input class="form-control" id="inputAddress" name="address" placeholder="Address"
                                       required type="text">
                            </div>
                            <div class="form-group col-md-4">
                                <label for="inputCity">City</label>
                                <input class="form-control" id="inputCity" name="city" placeholder="city" required
                                       type="text">
                            </div>
                            <div class="form-group col-md-4">
                                <label for="inputState">State</label>
                                <input class="form-control" id="inputState" name="state" placeholder="State"
                                       required type="text">
                            </div>
                            <div class="form-group col-md-4">
                                <label for="inputPincode">Pincode</label>
                                <input class="form-control" id="inputPincode" name="pincode" placeholder="Pincode"
                                       required type="number">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group col-md-4">
                                <label for="inputPhone">Phone No.</label>
                                <input class="form-control" id="inputPhone" name="inputPhone" placeholder="Phone No"
                                       required type="number" >
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group col-md-4">
                                <label for="email">Email</label>
                                <input class="form-control" id="email" name="email" placeholder="Enter Email" required
                                       type="email">
                            </div>
                            <div class="form-group col-md-4">
                                <label for="classOpted">Class Opted</label>
                                <input class="form-control" id="classOpted" name="classOpted" placeholder="Class Opted"
                                       required type="number" value="" min="5" max="10">
                            </div>
                            <div class="form-group col-md-4">
                                <label for="classOpted">Marks %</label>
                                <input class="form-control" id="marks" name="marks" placeholder="Marks"
                                       required type="number" value="" min="1" max="100">
                            </div>

                        </div>

                    </div>

                    <!-- /.card-body -->

                    <div class="card-footer">
                        <button class="btn btn-primary" type="submit">Add Student</button>
                        <input class="btn btn-warning" type="reset" value="Reset">

                    </div>
                </form>
            </div>
        </div>

    </div><!-- /.container-fluid -->
</section>
{% comment %} Checking if email and username already exists or not usin Ajax {% endcomment %}

<script type="text/javascript">

var today = new Date();
var dd = today.getDate();
var mm = today.getMonth()+1; //January is 0!
var yyyy = today.getFullYear()-10;
 if(dd<10){
        dd='0'+dd
    }
    if(mm<10){
        mm='0'+mm
    }

today = yyyy+'-'+mm+'-'+dd;
document.getElementById("dob").setAttribute("max", today);
</script>
<script>



        $(document).ready(function(){
            // keyup event will be triggered when user leaves keyboard
            $("#email").keyup(function(){
                var email = $(this).val();

                if(email!=""){
                    $.ajax({
                        url : '{% url 'check_email_exist' %}',
                        type : 'POST',
                        data : {email:email}
                    })
                    .done(function(response){
                        //console.log(response);

                        if(response == "True"){
                            $(".email_error").remove();
                            $("<span class='email_error' style='color: red; padding: 5px; font-weight: bold;'> Email Not Available. </span>").insertAfter("#email")
                        }
                        else{
                            $(".email_error").remove();
                            $("<span class='email_error' style='color: green; padding: 5px; font-weight: bold;'> Email Available. </span>").insertAfter("#email")
                        }
                    })

                    .fail(function(){
                        console.log("Failed");
                    })
                }
                else{
                    $(".email_error").remove();
                }

            })

            $("#inputPhone").keyup(function(){
                var inputPhone = $(this).val();

                if(inputPhone!=""){
                    $.ajax({
                        url : '{% url 'check_phone_exist' %}',
                        type : 'POST',
                        data : {inputPhone:inputPhone}
                    })
                    .done(function(response){
                        //console.log(response);

                        if(response == "True"){
                            $(".username_error").remove();
                            $("<span class='username_error' style='color: red; padding: 5px; font-weight: bold;'> Phone No. Not Available. </span>").insertAfter("#inputPhone")
                        }
                        else{
                            $(".username_error").remove();
                            $("<span class='username_error' style='color: green; padding: 5px; font-weight: bold;'> Phone No Available. </span>").insertAfter("#inputPhone")
                        }
                    })

                    .fail(function(){
                        console.log("Failed");
                    })
                }
                else{
                    $(".username_error").remove();
                }

            })
        })
    </script>

</body>

</html>